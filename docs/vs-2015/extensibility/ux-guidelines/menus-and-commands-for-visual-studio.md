---
title: 菜单和命令
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
caps.latest.revision: 5
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 681df08c02813e209738e629495190ad889caf31
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "68202102"
---
# <a name="menus-and-commands-for-visual-studio"></a>Visual Studio 的菜单和命令
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

## <a name="command-usage"></a>命令的用法

### <a name="overview"></a>概述
 与 Microsoft Office，这是包含许多单独的产品套件，不同的是 Visual Studio 包含许多产品，每个影响全局 Visual Studio IDE 到其命令集。 IDE 通过筛选可供用户使用基于上下文的功能来管理数千个命令的复杂性。

 如果用户的上下文更改 – 例如，在设计窗口中切换到编辑窗口的代码与功能无关的新上下文将消失。 在同一时间，以及相关的动态信息，例如属性和工具箱选项的新功能图面。 用户应该不会注意到可用的命令集的交换。 如果用户是很难理解或通过命令使其不显示或消失感到困惑，UI 设计需要调整。 用户的当前上下文始终指示在一个或多个方面，例如在 IDE 的标题栏、 属性窗口或属性页对话框。

 命令栏方便用户灵活地在 UI。 只有命令结构固有的环境是在主菜单和主要的命令栏，它可以同时进行自定义和甚至隐藏在 Visual Studio。 其他命令栏出现和消失基于应用程序的状态。 工具窗口和文档编辑器还可以包含嵌入的工具栏中其窗口边缘。

#### <a name="basic-guidelines"></a>基本指导原则

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>使用现有共享的命令、 命令组和菜单只要有可能。
 由于命令基于上下文通常所示，使用现有共享的菜单和命令组可确保命令结构保持相对稳定之间上下文中的更改。 重复使用共享的命令并将新命令接近相关共享命令放入还降低了 IDE 的复杂性，并创建更加友好的用户体验。 如果需要定义一个新的命令，请尝试将其放在现有共享的命令组。 如果需要定义新的组，将其放置在现有共享接近相关的命令组菜单中创建新的顶级菜单之前。

##### <a name="do-not-create-icons-for-every-command"></a>不要创建的每个命令的图标。
 在创建命令图标之前请仔细考虑。 应仅对命令创建图标的：

- 出现默认工具栏上。

- 可能由用户添加到通过工具栏**自定义...** 对话框。

- 具有与另一个 Microsoft 产品中相同的操作相关联的图标。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制添加了键盘快捷方式
 绝大多数用户都使用极小一部分的所有可用的快捷方式。 如有疑问，没有将绑定功能的键盘快捷方式。 添加新的快捷方式之前，使用你的用户的工作体验团队。

##### <a name="give-commands-a-default-menu-placement"></a>提供命令的默认菜单放置。
 请注意您的命令将由其他自定义，并相应地设计它们。 隐藏命令没有此类的内容。 所有 Visual Studio 命令显示在**工具 > 自定义**对话框中，命令窗口中，自动完成**工具 > 选项 > 键盘**对话框中和开发工具环境 (DTE)。 请确保为你的命令，指定名称和.ctc 文件中的工具提示，以便用户可以轻松地找到它们。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>不复制在嵌入式工具栏上的共享的命令。
 它可用于将命令放在紧靠该用户的关注领域。 若要执行此操作的一种方法是在工具窗口或文档的顶部编辑器创建嵌入式的工具栏。 放在工具栏上的命令应为特定于窗口内的内容区域。 不复制这些工具栏上的共享的命令。 例如，永远不会将放置在嵌入式工具栏上的"保存"图标。

### <a name="content-and-command-visibility"></a>内容和命令的可见性
 在以下范围中存在的命令：**环境**，**层次结构**，和**文档**。 知道每个作用域，才能确保命令放置。

 中的命令**环境**作用域建立主上下文和多个上下文之间共享。 这些更改的文档和工具窗口排列方式的可见性。 作用域包括在环境中的命令**新的项目**，**连接到服务器**，**附加进程**，**剪切**， **复制**，**粘贴**，**查找**，**选项**，**自定义**，**新窗口**，并**查看帮助**。

 中的命令**层次结构**作用域管理层次结构中包括 Visual Studio**项目**，**团队**，以及**数据**。 为项目的子上下文 – 例如，相关**调试**，**构建**，**测试**，**体系结构**，或**分析**. 作用域的层次结构中的命令**添加新项**，**新查询**，**项目设置**，**添加新数据源**， **启动性能向导**，并**新的关系图**。

 中的命令**文档**内容的文档，例如代码、 设计或工作项查询 (WIQ) 的作用域操作。 它们还作用于一个工具窗口的视图数据或为特定于该工具窗口。 文档作用域命令还作用于文件对象层次结构相关，例如自己**从项目中删除**。 作用域是在文档中的命令之间**重构 > 重命名**，**创建工作项的副本**，**全部展开**，**全部折叠**，和**创建用户任务**。

### <a name="command-placement-decisions"></a>命令放置决策
 一旦您已决定创建命令，你将需要确定其相应的位置以及是否创建键盘快捷方式。 请按照此决策路径来指定该命令的放置位置：

 ![命令放置决策图表](../../extensibility/ux-guidelines/media/0501-a-commandplacement.png "0501 a_CommandPlacement")

 **用于 Visual Studio 中的命令放置决策路径**

### <a name="command-placement-in-menus"></a>在菜单中的命令放置

#### <a name="main-menu-bar"></a>主菜单栏
 在主菜单栏应构成 UI 的任何特定于上下文菜单中包的命令的标准位置。 主菜单栏与其他命令结构不同，在环境中使用它来控制哪些命令都可见。 所有其他命令栏只需禁用命令的上下文中，它们放置在菜单上或在工具栏上。

 环境定义一组的主菜单栏中内置的在整个 IDE 和任务的多个域都是常见的命令。 这些命令是始终可见的而不考虑这些 Vspackage 加载到环境。 虽然 Vspackage 可以扩展此命令集，但是命令从每个产品和其命令的位置设置为每个团队的职责。

 Visual Studio 主菜单的结构可以分为以下菜单类别：

##### <a name="core-menus"></a>核心菜单

- 文件

- Edit

- 视图

- 工具

- 窗口

- Help

##### <a name="project-specific-menus"></a>特定于项目的菜单

- 项目

- Build

- 调试

##### <a name="context-specific-menus"></a>特定于上下文菜单

- 团队

- 数据

- 测试

- 体系结构

- 分析

##### <a name="document-specific-menus"></a>特定于文档的菜单

- 格式

- 表

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>在设计时主菜单，遵循这些规则：

- 不能超过 25 个顶级项目在给定上下文中

- 菜单应永远不会超过 600 像素高。

- Ultimate SKU 和常规配置文件中，如评估在多个上下文中，主菜单。

- 飞出式菜单是可接受的。

- 浮出菜单应包含至少三个项和不超过七个存储帐户。

- 深度飞出式菜单应该只有一个级别 – 某些 Visual Studio 的菜单项具有级联子菜单，但不是建议此模式。

- 使用不超过 6 个分隔符。 下图应遵循分组：

     ![主菜单分组指南](../../extensibility/ux-guidelines/media/0501-b-mainmenus.png "0501 b_MainMenus")

- 虽然它不需要具有在图中的每个分组，但添加其他分组是受限制。

- 每个分组应具有两个到七个菜单项。

#### <a name="main-menu-ordering"></a>主菜单中排序
 在添加新的顶级项之前, 请考虑将命令放在现有顶级菜单。 在添加新的顶级菜单时，请务必将其放在正确的位置。 确定菜单是否处于特定于项目、 上下文或文档。 保持简洁的顶级菜单名称，并且只有一个单词。

 核心菜单应书档其余的命令。 文件、 编辑和视图应始终为到左侧和工具窗口中，并帮助应始终是右对齐。

#### <a name="context-menus"></a>上下文菜单
 将过多的上下文菜单中的功能会导致很难了解接口。 所有主要功能应可通过在主菜单栏。 命令的位置应与现有命令，以避免重复命令进行对帐。 对于上下文菜单时，外壳可以定义应包括具体取决于上下文菜单是否为该解决方案、 项目节点或项目项的标准菜单组。

 在设计时上下文菜单，遵循相同的规则与主菜单中，并在添加：

- 不超过 25 顶级菜单项。

- 飞出式菜单是可接受，但必须不超过一个层次深度 – 永远不会使用级联浮出控件。

- 使用不超过 6 个分隔符。

### <a name="command-placement-in-toolbars"></a>在工具栏中的命令放置

#### <a name="general-toolbars"></a>常规工具栏
 在设计和排列工具栏时，应遵循这些标准：

- 不要使用每个按钮的多个谓词。 一个按钮 = 一个操作。

- 仅当需要将继续增强的标签，请使用图标旁边的文本。

- 以独占方式的属性，将在一个会话中多次切换使用组合框。 否则，公开到其他位置的属性。

- 组合框的宽度应等于内框 + 30%的时间最长的项的宽度。 例如，如果最长的项为 200 像素，组合框应为 260 像素宽。

- 限制使用的分隔符。 使用分隔符旁边的下拉列表中是一种反模式，因为形状的下拉列表中本身充当直观分隔符。

- 图标组应包含三到六个图标。

- 如果限定符导致多个有用的命令，使用存储的最后一个设置的拆分按钮：

     ![拆分在 Visual Studio 中的按钮](../../extensibility/ux-guidelines/media/0501-c-splitbuttons.png "0501 c_SplitButtons")

     **拆分按钮的示例。在左侧的六个命令可以改为适合于单个按钮。**

#### <a name="product-specific-toolbars"></a>特定于产品的工具栏
 每个产品可以提供包含经常使用的默认工具栏和重要命令和每个产品的默认工具栏应显示产品安装后，启动 Visual Studio 的第一个时间。

 共享的命令组和菜单提供的 IDE，还应利用产品。 每个共享的命令组置于共享菜单一直想整理相关的命令的用户有意义的方式。 请务必利用此共享的命令结构，以便降低复杂性。

#### <a name="global-toolbars"></a>全局工具栏
 需要以适应一个行直接在全局工具栏。 在创建新的全局工具栏时，遵循该工具栏类型的准则。

 **常规工具栏指导原则：**

- 每个工具栏公共控件 （控制手柄，溢出） 中有 24 个像素。

- 每个工具栏按钮是 22 个像素宽包括填充。 进行的拆分按钮的图标将添加另一个 11 像素为单位的宽度。

- 允许重复的跨工具栏的命令。

  **特定于文档的工具栏**特定文件类型处于活动状态时，将显示并在不同的文件类型将变为活动状态时消失。

- 特定于文档的工具栏不能超过 12 个按钮。

- 工具栏的总宽度不能超过 300 像素。

- 每个文件类型可以具有一个嵌入式的工具栏或一个特定于文档的全局工具栏上，但不是能同时。

  **特定于上下文的工具栏**特定上下文时，将显示已设置，往往会很长时间保持活动状态。

- 所有特定于上下文的工具栏的按钮限制为 18。

- 如果上下文处于活动状态时，大多数用户不会一致地使用此工具栏的命令，使用上下文不将此工具栏。

- 请确保，退出上下文时，工具栏将消失。 没有任何这些工具栏应在启动时显示。

  **没有上下文的工具栏**永远不会自动显示。 这些说明仅当用户激活它们。 保留以下 200 像素的最大宽度。

### <a name="general-organization-and-shell-defined-groups"></a>常规组织和命令行程序定义的组
 使用现有共享的命令、 命令组和菜单。 如果需要定义一个新的命令，请尝试将其放在现有共享的命令组。 如果需要定义新的组，请在创建新的顶级菜单之前将其放在现有共享接近相关的命令组菜单。 这将减少同时确保了在 IDE 中的一致命令放置命令复杂性。

 共享**格式**菜单中，通常显示在设计器样式文档窗口的上下文中在下图中所示：

 ![具有标注的 visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0501-d-formatmenu.png "0501 d_FormatMenu")

 **在 Visual Studio 中的菜单组**

### <a name="reducing-and-reusing-commands"></a>减少并重复使用的命令
 命令，将通常显示在上下文中，以减少用户将看到在任何给定时间的命令数。 但是，还应重复使用现有共享的菜单和命令组，以确保命令结构保持相对稳定的上下文中的更改之间。

 重复使用共享的命令并将新命令接近相关共享命令放入降低了 IDE 的复杂性，并创建更加友好的用户体验。

## <a name="naming-commands"></a>命名命令

### <a name="naming-conventions"></a>命名约定
 一致命令命名至关重要，以便用户可以查找并执行命令，通过使用命令行或绑定到的键盘快捷方式的不同而不同。 命令名称还帮助用户了解哪些命令可在工具栏上或级联或上下文菜单中显示时的用途。

#### <a name="when-naming-commands"></a>当命名命令：

- 构造的文本，以便更易于本地化。 有关文本本地化的详细信息，请参阅[本地化最佳做法](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)。

- 为简洁。 命令应使用不超过三个单词。

- 使用词首字母大写的大小写作： 每个单词的第一个字母大写。 有关 Visual Studio 中的文本格式的详细信息，请参阅[文本样式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。

- 请考虑将放置命令。 是在顶级菜单或弹出窗口？ 例如，当浮出控件的顶级命令中的分组对齐命令应为"对齐"和飞出式命令应为"Left、"右"、"中心，""两端对齐，"，依此类推。 这是多余命名飞出式命令"左对齐"或"向右对齐。"

     ![Visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0502-a-formatmenu.png "0502 a_FormatMenu")

### <a name="using-icons-with-commands"></a>通过命令使用图标
 在图标与命令配对使用适当使用。 尽管将与命令相关联的唯一映像 hastens 识别该命令的用户的能力，但视觉混乱和效率低下出现图像过度使用。 以下规则有助于确定是否要创建命令图标时。

#### <a name="use-an-icon-with-a-command-only-if"></a>将图标与命令仅当使用：

- 在同一命令具有另一个重要的 Microsoft 产品，如 Microsoft Office 应用程序中与之关联的图标。

- 该命令将放入默认工具栏。

- 该命令是一个特殊命令，用户很可能将添加到工具栏使用 **"自定义..."** 对话框。

## <a name="access-and-shortcut-keys"></a>访问键和快捷键

### <a name="overview"></a>概述
 有两种类型的键盘键分配方案：

- **访问密钥**（也称为加速器） 对话框 UI 中允许通过在菜单的键盘访问发出命令和每个标签。 访问密钥主要用于可访问性、 分配给所有菜单和大多数对话框控件，并不所存储，会影响仅当前窗口和已本地化。

- **键盘快捷方式**主要使用控件 (Ctrl) 和功能 (Fn) 按键顺序。 它们旨在更高级的用户和保持工作效率。 它们只分配给最常用的命令，并绕过主菜单时允许快速访问。 键盘快捷方式用于所存储，并且为此，原因必须分配与配置文件方案一致。 快捷方式的关键方案可能不同配置文件到配置文件。 用户可以自定义通过键盘快捷方式**工具 > 选项 > 键盘**。

### <a name="assigning-access-keys"></a>分配访问键
 访问密钥包含 Alt 加上字母数字键。 将访问密钥分配给每个菜单项没有异常。 按照 Windows 和通用约定，以便分配访问键。 例如，对于访问密钥**文件 > 新建**始终应**Alt，F，N**。

 不使用单一像素宽度形式，例如 i （在大写或小写） 还是小写字母 l，并避免使用下行字母 （g、 j、 p、 q 和 y） 的字符，因为这是难以区分。

 避免使用重复的键在可能的情况。 在重复是不可避免的情况下，菜单系统通过遍历所有命令，使用密钥处理冲突。 例如，对于"Number"命令文件菜单，因为"N"访问密钥下, 一个假想**Alt，F，N**会创建一个新文件，并**Alt、 F、 N、 N**会执行"数字"命令。

### <a name="assigning-shortcut-keys"></a>分配键盘快捷方式
 避免分配新键盘快捷方式，因为它们不需要为每个命令和税务系统 （和用户内存） 如果过度使用。 数据从客户体验改善计划 (CEIP) 指示 Visual Studio 用户使用只有一小部分的集成的快捷方式。

 在定义的快捷方式时，遵循以下规则：

- **使用控件 (Ctrl) 和功能 (Fn) 按键顺序。**

- **保留频繁使用的快捷方式。** 维护最受欢迎的快捷方式。

- **使编辑器快捷键容易键入。** 将简单类型的快捷方式绑定到开发人员编写代码时的最需要的命令。 例如， **Edit.InvokeSmartTag**需要快速快捷键如 Ctrl + 并不 Alt + Shift + F10。

- **尽可能一致地应用主题的快捷方式。**

- **请遵循 Windows 准则来确定哪些修饰符键使用。** 使用 Ctrl 键组合用于大型效果，如将应用到整个文档的命令的命令。 用于扩展或补充标准快捷键的操作的命令使用 Shift 键组合。 请勿使用 Ctrl + Alt 组合。

- **删除多余的快捷方式。** 如果您有一项旧功能，请考虑删除快捷方式，如果访问密钥提供了快速访问相同的命令与极少 （少于 10 次从 CEIP 数据） 被或中等均值 （少于 100 次从 CEIP 数据） 一起使用。 例如:Alt，H，C 会打开帮助/内容。

  不是简单的方法来检查快捷方式的可用性。 如果你想要添加快捷方式，执行以下步骤：

1. 检查的列表[Visual Studio 2013 快捷方式](http://visualstudioshortcuts.com/2013/)以确定是否有类似的命令进行分组你使用。

2. 转到**工具 > 选项 > 环境 > 键盘**和测试您的快捷方式。 检查每个键盘映射方案需要下列出"应用以下其他键盘映射方案"。 检查常规C#，VB，和C++配置文件，如那些共享唯一快捷方式。 如果未将其映射中的位置的任何可快捷方式。
