---
title: 调试 T4 文本模板
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, troubleshooting
- text templates, debugging
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: ec82c71a359bed423785cc914c58b97db954f4f5
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "62994667"
---
# <a name="debugging-a-t4-text-template"></a>调试 T4 文本模板
您可以在文本模板中设置断点。 若要调试的设计时文本模板，将文本模板文件，保存，然后选择**调试 T4 模板**在解决方案资源管理器中的文件的快捷菜单上。 若要调试的运行时文本模板，只需调试它所属的应用程序。

 若要调试文本模板，您应该了解模板转换过程的步骤。 不同类型的错误可以在每个步骤中出现。 步骤如下所示。

|步骤|设计时模板： 发生时|运行时模板： 发生时|
|-|-|-|
|从文本模板生成代码。<br /><br /> 指令中的错误或不匹配或 disordered`<#...#>`标记。|当保存模板，或调用文本转换。|当保存模板，或调用文本转换。|
|编译生成的代码。<br /><br /> 在模板代码中的编译错误。|紧跟在上一步。|以及应用程序代码。|
|代码运行。<br /><br /> 在模板代码中的运行时错误。|紧跟在上一步。|当你的应用程序运行，并调用模板代码。|

 在大多数情况下，错误报告中提供的模板代码中的行号。 当临时文件名引用错误报告时，则原因通常是在文本模板的代码中的括号不匹配。

 您可以在文本模板中设置断点并调试用通常的方式。

## <a name="common-errors-and-fixes"></a>常见错误和修补程序
 下表列出了最常见的错误和其修补程序。

|错误消息|描述|解决方案|
|-|-|-|
|未能加载基类的{0}的转换从类继承。|如果找不到基类中指定，则会发生`inherits`模板指令中的参数。 消息提供了模板指令的行号。|请确保存在指定的类，并且，在一个程序集指令中指定它存在于中的程序集。|
|未能解析的文件包含文本：{0}|找不到包含的模板时发生。 该消息提供的请求的包含文件的名称。|请确保文件路径是相对于原始模板路径，或该文件位于与主机注册的位置或者存在该文件的完整路径。|
|初始化转换对象时生成错误。 该转换将不会运行。|转换类的 initialize （）' 失败或返回 false 时发生。|Initialize （） 函数中的代码来自中指定的 base 转换类\<#@template#> 指令和从指令处理器。 导致初始化可能失败的错误是在错误列表上。 调查失败的原因。 您可以查看实际生成的代码 initialize （） 的过程来调试模板。|
|程序集 '{0}为指令处理器{1}未被授予 FullTrust 权限集。 允许仅受信任的程序集提供指令处理器。 将不加载此指令处理器。|系统不会向包含指令处理器的程序集授予 FullTrust 权限时发生。 该消息提供的程序集名称和指令处理器的名称。|请确保你仅在本地计算机上使用受信任的程序集。|
|路径{0}必须是此计算机的本地或受信任区域的一部分。|当指令或程序集指令引用是不在本地计算机或网络的受信任区域上的文件，则会出现。|请确保指令或程序集指令的位置的目录是在受信任区域中。 可以将网络目录添加到受信任区域中，通过 Internet Explorer。|
|例如，"无效标记 catch"或"命名空间不能直接包含成员"的多个语法错误|在模板代码中的右括号太多。 编译器将它误用与标准生成代码。|检查右大括号和括号内代码分隔符的数。|
|循环或不编译或执行正确的条件语句。 例如：`<#if (i>10)#> Number is: <#= i #>`。<br /><br /> 此代码始终输出的值我。 仅"数是:"是有条件。|在 C# 中，始终使用大括号括起来控制语句中嵌入的文本块。|添加大括号： `<#if (i>10) { #>    Number is: <#= i #><# } #>`。|
|"表达式太复杂"时处理设计时模板或编译运行时 （预处理过的） 模板。<br /><br /> 尝试检查由运行时模板生成的代码时，visual Studio 会停止工作。|文本块是太长。 T4 将文本块转换为具有一个字符串的每个模板行文本的字符串串联表达式。 很长的文本块可以超越编译器的大小限制。|如将表达式块的长文本块拆分：<br /><br /> `<#= "" #>`|

## <a name="warning-descriptions-and-fixes"></a>警告说明和修补程序
 下表列出了最常见的警告，以及修补程序，如果可用。

|警告消息|描述|解决方案|
|-|-|-|
|加载包含文件{0}返回了 null 或空字符串。|如果包含的文本模板文件为空，则会发生。 该消息提供了所包含的文件的文件名。|请删除 include 指令，或确保该文件具有一些内容。|
|正在编译转换：|前面添加到所有错误或警告源自编译器在编译转换时此字符串。 此字符串意味着编译器引发了错误或警告。|如果你有 DLL 遇到问题，可能需要提供的完整路径或完全限定的强名称，如果该 DLL 位于 gac。|
|参数{0}指令中已存在。 将忽略重复的参数。|指令中多次指定参数时出现。 该消息提供参数和指令的行号的名称。|删除重复的参数规范。|
|没有加载包含文件时出错{0}。 Include 指令将被忽略。|找不到文件中指定时，会发生`include`指令。 该消息提供文件和指令的行号的名称。|请确保包含文件存在于与原始文本模板文件相同的目录或一个已注册到主机的 include 目录中。|
|为 Transformation 类指定的基类无效。 基本类必须派生自 Microsoft.VisualStudio.TextTemplating.TextTransformation。|发生时`inherits`参数在模板指令中的指定不继承的类`TextTransformation`。 消息提供了模板指令的行号。|指定派生的类`TextTransformation`。|
|在 template 指令中指定了无效的区域性。 区域性必须采用"XX-XX"格式。 将使用固定区域性。|当错误地指定在模板指令中的区域性参数时发生。 消息提供了模板指令的行号。|更改为采用"XX-XX"格式是有效的区域性的区域性参数。|
|无效的调试值{0}的 template 指令中指定。 该调试值必须是"true"或"false"。 将使用默认值为"false"。|发生时`debug`错误地指定在模板指令中的参数。 消息提供了模板指令的行号。|调试参数设置为"true"或"false"。|
|无效的 HostSpecific 值{0}的 template 指令中指定。 HostSpecific 值必须为"true"或"false"。 将使用默认值为"false"。|发生时中的特定于宿主的参数`template`指令未正确指定。 消息提供了模板指令的行号。|特定于宿主的参数设置为"true"或"false"。|
|语言无效{0}template 指令中指定。 语言必须是"C#"或"VB"。 将使用"C#"的默认值。|不支持的语言指定在发生`template`指令。 仅"C#"或"VB"允许使用 （不区分大小写）。 消息提供了模板指令的行号。|设置`language`到"C#"或"VB"的 template 指令中的参数。|
|在模板中找到多个输出指令。 将忽略除第一个。|发生时多个`output`模板文件中指定指令。 消息提供了重复的输出指令的行号。|删除重复项`output`指令。|
|在模板中找到多个模板指令。 将忽略除第一个。 应在一个 template 指令中指定该 template 指令的多个参数。|如果指定多个，则会发生`template`文本模板文件 （包括包含的文件） 中的指令。 消息提供了重复的模板指令的行号。|聚合的不同`template`为一个指令`template`指令。|
|名为的指令指定没有处理器{0}。 将忽略该指令。|如果指定，则会发生`custom`指令，但不是提供`processor`属性。 消息提供的名称以及该指令的行号。|提供`processor`属性的名称与`directive`指令处理器。|
|名为的处理器{0}未找到名为指令{1}。 将忽略该指令。|当系统无法找到时发生`directive`中指定的处理器`custom`指令。 该消息提供指令的名称、 处理器名称和该指令的行号。|设置`processor`为指令处理器的名称在指令中的属性。|
|所需的参数{0}的指令{1}找不到。 将忽略该指令。|系统不提供所需的指令参数时发生。 该消息提供缺少的参数的名称、 指令的名称和行号。|提供缺少的参数。|
|处理器名为{0}不支持名为的指令{1}。 将忽略该指令。|指令处理器不支持指令时发生。 消息提供指令处理器的名称以及有问题的指令的名称和行的号。|更正指令的名称。|
|文件的 include 指令{0}将导致无限循环。|如果循环 include 指令，则显示指定 （例如，文件的包含文件 B，其中包含文件 A）。|未指定循环 include 指令。|
|运行转换：|此将字符串追加到所有错误或运行转换时生成的警告。|不适用。|
|在块内找到意外的开始或结束标记。 请确保未错误地键入开始或结束标记，并且你不在模板中包含任何嵌套的块。|显示当你有了意外\<# >。 也就是说，如果您有\<# 之后另一个打开的标记的未关闭，或者您所需 #> 之前它没有闭合打开标记时。 消息提供不匹配的标记的行号。|请删除不匹配的开始或结束标记，或使用转义符。|
|格式不正确指定了某个指令。 将忽略该指令。 请指定指令格式 `<#@ name [parametername="parametervalue"]*  #>`|如果未以正确的格式指定指令，则显示分析器。 消息提供不正确的指令的行号。|确保所有指令都处于窗体`<#@ name [parametername="parametervalue"]*  #>`。 有关详细信息，请参阅[T4 文本模板指令](../modeling/t4-text-template-directives.md)。|
|无法加载程序集 '{0}为已注册的指令处理器{1}<br /><br /> {2}|无法加载指令处理器，由主机时发生。 此消息标识为指令处理器和指令处理器的名称提供的程序集。|请确保已正确注册指令处理器，以及该程序集是否存在。|
|未能找到类型{0}中程序集{1}为已注册的指令处理器{2}<br /><br /> {3}|无法从其程序集加载的指令处理器类型时发生。 该消息提供的类型、 程序集和指令处理器的名称。|Vshost，位于注册表中查找指令处理器信息 （名称、 程序集和类型）。 请确保正确，注册指令处理器和该类型存在于程序集。|
|无法加载程序集{0}|当一个程序集加载问题时发生。 该消息提供的程序集的名称。|可以指定要在加载程序集\<@# assembly #> 指令，并通过指令处理器。 在此字符串后面的错误消息应提供更多的数据上的程序集加载失败的原因。|
|出现的问题创建和初始化名为的指令处理器{1}。 处理器的类型是{0}。 将忽略该指令。|当系统无法创建或初始化指令处理器时发生。 该消息提供的指令的名称和行号和处理器的类型。|请确保使用正确的指令处理器，并且指令处理器具有公共默认构造函数。 否则，使用调试选项以找出失败的指令处理器的 initialize （） 方法的原因。 有关详细信息，请参阅[故障排除文本模板](../modeling/debugging-a-t4-text-template.md)。|
|处理名为的指令时引发了异常{0}。|处理指令的指令处理器将引发异常时发生。|请确保为指令处理器参数正确。|
|主机引发了异常时尝试解析程序集引用{0}。|当主机尝试解析程序集引用时引发异常时发生。 该消息提供了该程序集引用字符串。|程序集引用来自\<@# assembly #> 指令和从指令处理器。 请确保程序集参数中提供的 name 参数正确。|
|尝试指定不受支持{1}值{0}指令 {2}|RequiresProvidesDirectiveProcessor （全部从其派生我们生成的指令处理器），情况发生时，提供不受支持，要求，或提供自变量。|确保，name = 中的名称值对中提供要求，并提供参数是否正确。|