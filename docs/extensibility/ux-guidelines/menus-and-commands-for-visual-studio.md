---
title: 视觉工作室的菜单和命令 |微软文档
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: c1f22b7ac4377b600208c079b6af1eff7fc3cbfc
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/06/2020
ms.locfileid: "80698386"
---
# <a name="menus-and-commands-for-visual-studio"></a>Visual Studio 的菜单和命令
## <a name="command-usage"></a>命令使用

### <a name="overview"></a>概述
 与 Microsoft Office（一个包含许多独立产品的套件）不同，Visual Studio 包含许多产品，每个产品都向全局视觉工作室 IDE 贡献其命令集。 IDE 通过根据上下文筛选用户可用的功能来管理数千个命令的复杂性。

 当用户的上下文发生更改（例如从设计窗口切换到代码编辑窗口）时，与新上下文无关的功能将消失。 同时，新功能与相关的动态信息（如属性和工具箱选项）一起显示。 用户不应注意到可用命令集的交换。 如果用户因出现或消失的命令而分心或混淆，则 UI 设计需要调整。 用户的当前上下文始终以一个或多个方式表示，例如在 IDE 标题栏、属性窗口或属性页对话框中。

 命令栏允许在 UI 中具有灵活性。 Visual Studio 环境固有的唯一命令结构是主菜单和主命令栏，它们既可以自定义，也可以隐藏。 其他命令栏会根据应用程序的状态显示和消失。 工具窗口和文档编辑器还可以在其窗口边缘包含嵌入工具栏。

#### <a name="basic-guidelines"></a>基本准则

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>尽可能使用现有的共享命令、命令组和菜单。
 由于命令通常基于上下文显示，因此使用现有的共享菜单和命令组可确保在上下文中更改之间命令结构保持相对稳定。 重用共享命令并将新命令放置在相关共享命令附近也会降低 IDE 复杂性，并创建更用户友好的体验。 如果需要定义新命令，请尝试将其放置在现有的共享命令组中。 如果需要定义新组，则在创建新的顶级菜单之前，将其放置在靠近相关命令组的现有共享菜单中。

##### <a name="do-not-create-icons-for-every-command"></a>不要为每个命令创建图标。
 在创建命令图标之前，请仔细考虑。 图标应仅针对以下命令创建：

- 显示在默认工具栏上。

- 用户可能会通过 **"自定义..."** 对话框添加到工具栏中。

- 在另一个 Microsoft 产品中具有与同一操作关联的图标。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制键盘快捷键的添加
 绝大多数用户使用所有可用快捷方式的一小部分。 如有疑问，不要将功能绑定到键盘快捷键。 在添加新快捷方式之前，请与您的用户体验团队合作。

##### <a name="give-commands-a-default-menu-placement"></a>为命令提供默认菜单放置位置。
 请注意，您的命令将由其他人自定义并相应地进行设计。 不存在隐藏命令。 所有可视化工作室命令都显示在 **"工具>自定义**"对话框、命令窗口、自动完成 **、"工具>选项>键盘**对话框以及开发工具环境 （DTE） 中。 请确保在 .ctc 文件中为命令指定名称和工具提示，以便用户可以轻松找到它们。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>不要复制嵌入工具栏上的共享命令。
 将命令放置在靠近用户焦点区域的位置非常有用。 执行此操作的一种方法是在工具窗口或文档编辑器的顶部创建一个嵌入工具栏。 放置在工具栏上的命令应特定于窗口中的内容区域。 不要在这些工具栏上复制共享命令。 例如，切勿在嵌入工具栏中放置"保存"图标。

### <a name="content-and-command-visibility"></a>内容和命令可见性
 命令存在于以下作用域中：**环境**、**层次结构**和**文档**。 了解每个范围，以便对命令放置有信心。

 **"环境"** 作用域中的命令建立主上下文，并在多个上下文之间共享。 它们改变了文档和工具窗口的可见性或排列。 环境范围内的命令包括**新项目**、**连接到服务器**、**附加进程**、**剪切**、**复制**、**粘贴**、**查找**、**选项**、**自定义**、**新窗口**和**查看帮助**。

 **层次结构**作用域中的命令管理可视化工作室中的层次结构，包括**项目**、**团队**和**数据**。 它们与项目的子上下文相关，例如 **，调试**、**生成**、**测试**、**体系结构**或**分析**。 层次结构作用域中的命令包括 **"添加新项**"、"**新查询**"、"**项目设置**"、"**添加新数据源**"、"**启动性能向导**"和 **"新图**"。

 **"文档**"作用域中的命令对文档的内容（如代码、设计或工作项查询 （WIQ））执行操作。 它们还作用于工具窗口的视图，或者特定于该工具窗口。 文档范围命令还对本身特定于层次结构的文件对象执行操作，例如从 Project**中删除**。 在文档作用域中的命令包括**重构>重命名**、**创建工作项的副本**、**展开所有**项、**折叠所有**和**创建用户任务**。

### <a name="command-placement-decisions"></a>命令放置决策
 决定创建命令后，需要确定其适当的位置以及是否创建键盘快捷键。 按照此决策路径确定命令的放置位置：

 ![命令放置决策图表](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501-a_CommandPlacement")

 **可视化工作室中命令放置的决策路径**

### <a name="command-placement-in-menus"></a>命令放置在菜单中

#### <a name="main-menu-bar"></a>主菜单栏
 主菜单栏应为任何特定于上下文的菜单包的命令的标准位置，这些菜单包有助于 UI。 主菜单栏与其他命令结构不同，因为环境使用它来控制哪些命令可见。 所有其他命令栏只是禁用断章取义的命令，无论这些命令是放置在菜单还是工具栏上。

 环境定义一组内置于主菜单栏中的命令，这些命令在整个 IDE 和多个任务域中很常见。 无论将哪些 VS 包加载到环境中，这些命令始终可见。 尽管 VSPackages 可以扩展这组命令，但每个产品的命令集及其命令的位置是每个团队的责任。

 Visual Studio 主菜单的结构可以细分为以下菜单类别：

##### <a name="core-menus"></a>核心菜单

- 文件

- 编辑

- 视图

- 工具

- 窗口

- 帮助

##### <a name="project-specific-menus"></a>特定于项目的菜单

- Project

- 构建

- 调试

##### <a name="context-specific-menus"></a>特定于上下文的菜单

- 团队

- 数据

- 测试

- 体系结构

- 分析

##### <a name="document-specific-menus"></a>特定于文档的菜单

- 格式

- 表

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>设计主菜单时，遵循以下规则：

- 在给定上下文中不要超过 25 个顶级项目

- 菜单的高度不应超过 600 像素。

- 在多个上下文中评估主菜单，例如在终极 SKU 和常规配置文件中。

- 飞出菜单是可以接受的。

- 飞出菜单应包含至少三个项目，不超过七个。

- 飞出菜单应该只深入一级 - 某些 Visual Studio 菜单项具有级联子菜单，但不鼓励此模式。

- 使用不超过六个分隔符。 分组应遵循以下说明：

     ![主菜单分组指南](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501-b_MainMenus")

- 虽然不需要在图形中包含每个分组，但添加其他分组受到限制。

- 每个分组应具有 2 到 7 个菜单项。

#### <a name="main-menu-ordering"></a>主菜单订购
 在添加新的顶级项之前，请考虑将命令放在现有的顶级菜单中。 添加新的顶级菜单时，请确保将其放置在正确的位置。 确定菜单是特定于项目、上下文还是文档。 保持顶级菜单的名称简洁，只使用一个单词。

 核心菜单应预订其余命令。 文件、编辑和视图应始终在左侧，工具、窗口和帮助应始终在右侧。

#### <a name="context-menus"></a>上下文菜单
 在上下文菜单中放置过多的功能会导致一个难以学习的界面。 所有主要功能都应通过主菜单栏提供。 命令的位置应与现有命令协调，以避免重复的命令。 对于上下文菜单，shell 定义应包含的标准菜单组，具体取决于上下文菜单是用于解决方案、项目节点还是项目项。

 设计上下文菜单时，遵循与主菜单相同的规则，此外：

- 不要超过 25 个顶级菜单项。

- 飞出菜单是可以接受的，但不得超过一级深度 - 切勿使用级联飞出。

- 使用不超过六个分隔符。

### <a name="command-placement-in-toolbars"></a>命令放置在工具栏中

#### <a name="general-toolbars"></a>一般工具栏
 设计和安排工具栏时，请遵循以下标准：

- 每个按钮不要使用多个动词。 一个按钮 = 一个操作。

- 仅当图标需要使用标签进行强化时，才在图标旁边使用文本。

- 对将在一个会话中多次切换的属性，对属性使用组合框。 否则，在别处公开属性。

- 组合框的宽度应等于框中最长项目的宽度 = 30%。 例如，如果最长的项目为 200 像素，则组合框应为 260 像素宽。

- 限制分离器的使用。 下拉列表旁边的分隔符的使用是反模式，因为下拉列表本身的形状充当视觉分隔符。

- 图标组应包含三到六个图标。

- 如果限定符导致多个有用的命令，请使用存储最后一个设置的拆分按钮：

     ![Visual Studio 中的“拆分”按钮](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501-c_SplitButtons")

     **拆分按钮的示例。左边的六个命令可以装入一个按钮。**

#### <a name="product-specific-toolbars"></a>特定于产品的工具栏
 每个产品都可以提供一个默认工具栏，其中包含常用和重要命令，并且每个产品的默认工具栏应在安装产品后首次启动 Visual Studio 时显示。

 产品还应利用 IDE 提供的共享命令组和菜单。 每个共享命令组都放置在共享菜单中，旨在以有意义的方式为用户组织相关命令。 请务必利用此共享命令结构来降低复杂性。

#### <a name="global-toolbars"></a>全局工具栏
 全局工具栏需要开箱即用即可容纳一行。 创建新的全局工具栏时，请遵循该工具栏类型的指南。

 **一般工具栏指南：**

- 每个工具栏在常见控件中具有 24 个像素（夹持器、溢出）。

- 每个工具栏按钮宽 22 像素，包括填充。 使图标拆分按钮会添加另外 11 像素的宽度。

- 允许跨工具栏复制命令。

  当特定文件类型处于活动状态时，将显示**特定于文档的工具栏**，当其他文件类型变为活动时，该工具栏将消失。

- 特定于文档的工具栏可能不超过 12 个按钮。

- 工具栏的总宽度不得超过 300 像素。

- 每个文件类型可以有一个嵌入工具栏或一个特定于文档的全局工具栏，但不能同时具有两者。

  设置特定上下文时会出现**特定于上下文的工具栏**，并倾向于长时间保持活动状态。

- 所有特定于上下文工具栏的按钮限制为 18。

- 如果大多数用户在上下文处于活动状态时不会始终使用此工具栏的命令，则不要将此工具栏与上下文相关联。

- 确保工具栏在退出上下文时消失。 启动时不应出现这些工具栏。

  **没有上下文的工具栏**永远不会自动显示。 仅当用户激活它们时，才会显示这些内容。 将最大宽度保持在 200 像素以下。

### <a name="general-organization-and-shell-defined-groups"></a>常规组织和 shell 定义的组
 使用现有的共享命令、命令组和菜单。 如果需要定义新命令，请尝试将其放置在现有的共享命令组中。 如果需要定义新组，请尝试将其放置在靠近相关命令组的现有共享菜单中，然后再创建新的顶级菜单。 这降低了命令复杂性，同时确保在 IDE 中放置一致的命令。

 共享**格式**菜单（通常显示在设计器样式的文档窗口上下文中）如下图像所示：

 ![具有标注的 Visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501-d_FormatMenu")

 **可视化工作室中的菜单组**

### <a name="reducing-and-reusing-commands"></a>减少和重用命令
 命令通常基于上下文显示，以减少用户在任何给定时间看到的命令数。 但是，您还应重用现有的共享菜单和命令组，以确保命令结构在上下文中的更改之间保持相对稳定。

 重用共享命令并将新命令放置在相关共享命令附近，可降低 IDE 复杂性，并创建更用户友好的体验。

## <a name="naming-commands"></a>命名命令

### <a name="naming-conventions"></a>命名约定
 一致的命令命名至关重要，以便用户可以通过使用命令行或绑定到键盘快捷方式来查找和执行命令。 命令名称还可帮助用户了解命令显示在工具栏或级联或上下文菜单中时使用什么用途。

#### <a name="when-naming-commands"></a>命名命令时：

- 构造文本，以便易于本地化。 有关本地化文本的更多，请参阅[本地化最佳实践](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)。

- 简洁。 命令不应超过三个单词。

- 使用标题大小写：每个单词的第一个字母应大写。 有关可视化工作室中文本格式的详细信息，请参阅[文本样式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。

- 考虑命令的放置位置。 是顶级菜单还是弹出窗口？ 例如，在弹出窗口中对对齐命令进行分组时，顶级命令应为"对齐"，而飞出命令应为"左"、"右"、"中心"、"对齐"等。 将飞出命令命名为"向左对齐"或"向右对齐"是多余的。

     ![Visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502-a_FormatMenu")

### <a name="using-icons-with-commands"></a>将图标与命令一起使用
 在使用图标与命令配对时要谨慎。 尽管将唯一图像与命令关联会加速用户识别该命令的能力，但图像过度使用会造成视觉混乱和效率低下。 以下规则有助于决定是否创建命令图标。

#### <a name="use-an-icon-with-a-command-only-if"></a>仅当：

- 同一命令在另一个著名的 Microsoft 产品（如 Microsoft Office 应用程序之一）中具有与其关联的图标。

- 该命令将放置在默认工具栏中。

- 该命令是用户可能使用 **"自定义..."** 对话框添加到工具栏的专用命令。

## <a name="access-and-shortcut-keys"></a>访问和快捷键

### <a name="overview"></a>概述
 键盘键分配有两种：

- **访问键**（也称为快捷键）允许键盘通过菜单进行命令和对话框 UI 中的每个标签的访问。 访问键主要用于辅助功能，分配给所有菜单和大多数对话框控件，不用于记忆，仅影响当前窗口，并且本地化。

- **快捷键**主要使用控制 （Ctrl） 和函数 （Fn） 键序列。 它们专为高级用户而设计，有助于提高生产效率。 它们仅分配给最常用的命令，并允许在绕过主菜单时快速访问。 快捷键旨在被记住，因此必须分配与配置文件方案一致的设置。 快捷键方案可能因配置文件而异。 用户可以通过**工具>选项>键盘**自定义快捷键。

### <a name="assigning-access-keys"></a>分配访问密钥
 访问键由 Alt 加上字母数字键组成。 毫无例外地为每个菜单项分配访问键。 遵循 Windows 和通用约定来分配访问密钥。 例如，**文件> New**的访问密钥应始终为**Alt、F、N**。

 请勿使用单像素宽度字母，如"i"（大写或小写）或小写"l"，并且避免使用带有下行名（g、j、p、q 和 y）的字符，因为这些字母很难区分。

 尽可能避免使用重复的键。 在重复不可避免的情况下，菜单系统通过循环浏览使用键的所有命令来处理冲突。 例如，对于复制"N"访问密钥的文件菜单下的假想"数字"命令 **，Alt、F、N**将创建新文件 **，Alt、F、N、N**将执行"Number"命令。

### <a name="assigning-shortcut-keys"></a>分配快捷键
 避免分配新的快捷键，因为每个命令都不需要它们，如果使用过度，则对系统（和用户内存）征税。 来自客户体验改善计划 （CEIP） 的数据显示，Visual Studio 用户仅使用集成快捷方式的一小部分。

 定义快捷方式时，请遵循以下规则：

- **使用控制 （Ctrl） 和函数 （Fn） 键序列。**

- **保留常用的快捷方式。** 维护最流行的快捷方式。

- **使编辑器快捷方式易于键入。** 在编写代码时，将易于键入的快捷方式绑定到开发人员最需要的命令。 例如 **，Edit.InvokeSmartTag**需要具有快速快捷键（如 Ctrl+/，而不是 Alt_Shift_F10）。

- **争取一致的主题捷径。**

- **按照 Windows 指南确定要使用哪些修改器键。** 对具有大规模效果的命令（如应用于整个文档的命令）使用 Ctrl 组合。 对扩展或补充标准快捷键操作的命令使用 Shift 组合。 不要使用 Ctrl_Alt 组合。

- **删除无关的快捷方式。** 如果您有旧功能，请考虑删除使用极非频（从 CEIP 数据少于 10 倍）或中等非频（从 CEIP 数据小于 100 次）的快捷方式（如果访问密钥提供对同一命令的快速访问。 例如：Alt、H、C 将打开帮助/内容。

  没有一个简单的方法来检查快捷方式的可用性。 如果要添加快捷方式，请按照以下步骤操作：

1. 检查 Visual [Studio 2013 快捷方式](http://visualstudioshortcuts.com/2013/)的列表，以确定是否有类似的命令对您的命令进行分组。

2. 转到 **"工具>选项>环境>键盘**并测试您的快捷方式。 检查"应用以下附加键盘映射方案"下列出的每个键盘映射方案。 检查常规、C#、VB 和C++配置文件，因为这些配置文件共享唯一的快捷方式。 如果快捷方式未在其中任何一个位置映射，则其可用。
