---
title: 向代码清单 |微软文档
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 17ecacea-397d-4a97-b003-01bd5d56e936
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 768561ef289f0f652f082d40ee9856843721f1ff
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/06/2020
ms.locfileid: "80707268"
---
# <a name="manifest-to-code"></a>Manifest to Code
"向代码清单"工具是一个控制台应用程序，它为 Visual Studio 影像服务获取 .imagemanifest 文件，并生成包装文件或文件，用于引用影像清单的值，用于 C++、C#、VB 或 .vsct 文件，用于 Visual Studio 扩展名。 此工具生成包装文件，可用于直接从 Visual Studio 影像服务请求图像，或者如果代码不处理其自己的任何 UI 和呈现，则用于通过 API 传递清单值。

## <a name="how-to-use-the-tool"></a>如何使用该工具
 **语法**

 清单代码/清单：\<图像清单文件>/语言：\<代码语言>\<可选Args>

 **自变量**

||||
|-|-|-|
|**切换名称**|**说明**|**必需或可选**|
|/清单|用于创建或更新代码包装器的图像清单的路径。|必选|
|/语言|生成代码包装器的语言。<br /><br /> 有效值：CPP、C++、CS、C夏普、C#、VB 或 VSCT 这些值不区分大小写。<br /><br /> 对于 VSCT 语言选项，将忽略 /monikerClass、/classAccess 和 /命名空间选项。|必选|
|/图像 IdClass|图像 IdClass 的名称和工具创建的关联文件。 对于C++语言选项，仅生成 .h 文件。<br /><br /> 默认值：\<清单路径>_MyImageIds。\<朗·特特·>|可选|
|/名字类别|名字对象类的名称和工具创建的关联文件。 对于C++语言选项，仅生成 .h 文件。 对于 VSCT 语言，将忽略这一点。<br /><br /> 默认值：\<清单路径>_MyMonikers。\<朗·特特·>|可选|
|/类访问|图像 IdClass 和名字类别的访问修改器。 确保访问修改器对给定语言有效。 对于 VSCT 语言选项，将忽略此选项。<br /><br /> 默认值：公共|可选|
|/命名空间|在代码包装器中定义的命名空间。 对于 VSCT 语言选项，将忽略此选项。 无论选择何种语言选项，'.'或"：："都是有效的命名空间分隔符。<br /><br /> 默认值：我的图像|可选|
|/noLogo|设置此标志将停止打印产品和版权信息。|可选|
|/?|打印帮助信息。|可选|
|/help|打印帮助信息。|可选|

 **示例**

- 清单代码/清单：D：\Mymanifest.图像清单/语言：CSharp

- 清单Tocode/清单：D：\MyManifest.imagemanifest/语言：C++/命名空间：我的：：：名称空间/图像IdClass：MyImageIds/名字类别：MyMonikers/classAccess：朋友

- 清单代码/清单：D：\MyManifest.图像清单/语言：VSCT/图像IdClass：MyImageIds

## <a name="notes"></a>说明

- 我们建议您将此工具与"来自资源清单"工具生成的图像清单一起使用。

- 该工具仅查看符号条目以生成代码包装器。 如果图像清单不包含符号，则生成的代码包装器将为空。 如果图像清单中有一个不使用符号的图像或图像集，则它们将从代码包装器中排除。

## <a name="sample-output"></a>示例输出
 **C# 包装**

 C# 的一对简单图像 ID 和图像名字对象类将类似于以下代码：

```csharp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using System;

namespace MyImages
{
    public static class MyImageIds
    {
        public static readonly Guid AssetsGuid = new Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}");

        public const int MyImage1 = 0;
        public const int MyImage2 = 1;
    }
}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using Microsoft.VisualStudio.Imaging.Interop;

namespace MyImages
{
    public static class MyMonikers
    {
        public static ImageMoniker MyImage1 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage1 }; } }
        public static ImageMoniker MyImage2 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage2 }; } }
    }
}
```

 **C++包装**

 一对用于C++的简单图像 ID 和图像名字对象类将类似于以下代码：

```cpp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include <guiddef.h>

namespace MyImages {

class MyImageIds {
public:

    static const GUID AssetsGuid;

    static const int MyImage1 = 0;
    static const int MyImage2 = 1;

};

__declspec(selectany) const GUID MyImageIds::AssetsGuid = {0x442d8739,0xefde,0x46a4,{0x8f,0x29,0xe3,0xa1,0xe5,0xe7,0xf8,0xb4}};

}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include "ImageParameters140.h"
#include "MyImageIds.h"

namespace MyImages {

class MyMonikers {
public:

    static const ImageMoniker MyImage1;
    static const ImageMoniker MyImage2;

};

__declspec(selectany) const ImageMoniker MyMonikers::MyImage1 = { MyImageIds::AssetsGuid, MyImageIds::MyImage1 };
__declspec(selectany) const ImageMoniker MyMonikers::MyImage2 = { MyImageIds::AssetsGuid, MyImageIds::MyImage2 };

}
```

 **可视基本包装器**

 Visual Basic 的一对简单图像 ID 和图像名字对象类将类似于以下代码：

```vb
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports System

Namespace MyImages

    Public Module MyImageIds

        Public Shared ReadOnly AssetsGuid As Guid = New Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}")

        Public Const MyImage1 As Integer = 0
        Public Const MyImage2 As Integer = 1

    End Module

End Namespace
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports Microsoft.VisualStudio.Imaging.Interop

Namespace MyImages

    Public Module MyMonikers

        Public Readonly Property MyImage1
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage1}
            End Get
        End Property

        Public Readonly Property MyImage2
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage2}
            End Get
        End Property

    End Module

End Namespace
```

 **VSCT 包装器**

 .vsct 文件的一组图像 ID 将类似于：

```xml
<?xml version='1.0' encoding='utf-8'?>
<!--
- [auto-generated]
     This code was generated by the ManifestToCode tool.
     Tool Version: 14.0.15198
- [/auto-generated]
-->
<CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable">
  <Symbols>
    <GuidSymbol name="AssetsGuid" value="{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}">
      <IDSymbol name="MyImage1" value="0" />
      <IDSymbol name="MyImage2" value="1" />
    </GuidSymbol>
  </Symbols>
</CommandTable>
```
