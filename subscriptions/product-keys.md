---
title: 使用产品密钥 | Microsoft 文档
author: evanwindom
ms.author: jaunger
manager: evelynp
ms.date: 10/03/2017
ms.topic: conceptual
description: 了解如何获取和管理 Visual Studio 订阅中的产品密钥。
searchscope: VS Subscription
ms.openlocfilehash: 74d13602dd27669233cd40ebdd2f5e165c09079a
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "62977707"
---
# <a name="using-product-keys-in-visual-studio-subscriptions"></a>使用 Visual Studio 订阅中的产品密钥

Visual Studio 订阅允许访问一系列 Microsoft 产品来设计、开发、测试和演示应用程序。 其中一些产品在安装过程中需要产品密钥，一些产品需要激活。

对于当前版本的 Windows 和 Office 产品，Visual Studio 订阅通常包含 5 个产品密钥；对于较早版本，通常包含 3 个产品密钥。

大多数产品密钥都支持产品的每个密钥对其进行多次激活。  许多产品还允许在未激活的情况下安装产品并使用 30 天或更长时间。  对于大多数订阅者来说，这种提供了更多激活次数，以满足他们的需求。  但是，如果已用完产品的可用激活次数，可以通过 Visual Studio [订阅客户服务](https://visualstudio.microsoft.com/subscriptions/support/)提交获取其他密钥的请求。

## <a name="activating-a-product"></a>激活产品
某些产品需要激活。  在 Visual Studio 订阅中通常限于 Windows、Windows Server、Microsoft Office 客户端应用程序以及 Expression Studio。 对于需要激活的情况，许多产品（包括 Windows 和 Office）都允许在未激活的情况下安装产品并使用 30 天或更长时间。 如果频繁地（每 30 天至少一次）重建计算机映像，建议不激活产品。 在 Visual Studio 订阅中提供的产品密钥不允许无限次地激活产品。

如果已索取订阅中所有可用的产品密钥，并且已经达到激活次数限制，那么可以联系本地的 Visual Studio 订阅[客户服务中心](https://visualstudio.microsoft.com/subscriptions/support/)请求其他密钥。 请求则视具体问题具体分析。 如果获得批准，就可以在“[下载](https://my.visualstudio.com/downloads)”中获取产品密钥。

## <a name="retail-and-volume-licensing-versions-of-products"></a>产品的零售版本和批量许可版本
Visual Studio 订阅提供一系列零售版本和批量许可版本的 Microsoft 产品。 某些由“下载”提供的产品仅有零售版本或批量许可版本；某些则兼具两种版本。 通常，Windows、Windows Server 和 Office 客户端产品等需要激活的产品仅通过“下载”提供零售版本。

批量许可客户也可从批量许可服务中心 (VLSC) 下载软件，从而获得产品的批量许可版本（以及相应的产品密钥）。  客户所在组织的指定管理员负责管理 VLSC 的访问权限。

## <a name="daily-product-key-claim-limits"></a>每日产品密钥索取上限
Microsoft 致力于维护 Visual Studio 订阅计划的完整性以及该计划的合法订阅者就其投资获得软件和权益的价值。 为实现此承诺，Microsoft 对 Visual Studio 订阅实施了每日密钥索取上限。 每日密钥索取上限限定了每个订阅每日可索取的密钥数量。

除 Visual Studio Professional (MPN) 的每日密钥索取上限为 7 个以外，所有 Visual Studio 订阅（包括通过 MPN、BizSpark、MCT 软件与服务和 MCT 提供的订阅）的每日密钥索取上限都是 10 个。

注意:密钥索取上限可能更改。 请在此处查看最新的索取上限。

如果 24 小时内索取的密钥数量已达到订阅所允许的最大数量，那么将会看到错误提示，告知你已达到索取上限。 限制每隔 24 小时重置一次，从太平洋时间的凌晨 12:01 开始。

研究表明，大多数订阅者的订阅中所含产品密钥的数量足以满足他们的需求。 如果需要其他密钥，可通过 Visual Studio 订阅[客户服务](https://visualstudio.microsoft.com/subscriptions/support/)提交请求，我们将根据具体情况考虑是否批准你的请求。

## <a name="locating-and-claiming-product-keys"></a>查找并索取产品密钥
必须登录你的 Visual Studio 订阅才能查看产品密钥。 可在如下所示的“[下载](https://my.visualstudio.com/downloads)”页中，选择某一特定产品的蓝色“获取密钥”链接来查找单个产品密钥。  所有密钥都可在“[产品密钥](https://my.visualstudio.com/productkeys?wt.mc_id=o~msft~docs)”页查找到。 如果一个产品有多个密钥，会在下载项的“注释”列中显示注释，帮助你确定应使用哪个密钥。
> [!div class="mx-imgBorder"]
> ![从“下载”页获取密钥](_img/product-keys/download-get-key.png)

某些产品将其多个版本捆绑到单次下载中。 在这种情况下，输入的产品密钥决定安装的产品版本。
某些密钥会自动提供，例如“静态”密钥，同一个密钥可以根据需要使用无数次，因为不需要激活。 其他密钥必须通过选择该产品的“获取密钥”链接来索取。

根据具体的产品，有多种密钥类型可供选择。

### <a name="product-key-types"></a>产品密钥类型

|    密钥类型           |    说明                                                                                                                                                                                                           |
|-------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    不适用                    |    安装此产品不需要密钥。                                                       |
|    零售                     |    零售密钥允许多次激活，适用于产品的零售版本。 在许多情况下，每个密钥允许激活 10 次，不过在同一台计算机中通常允许激活更多次。                                                       |
|    多次激活        |    多次激活密钥 (MAK) 允许使用同一密钥多次安装某产品。 MAK 通常适用于批量许可版本的产品。 通常情况下，一次订阅仅提供一个 MAK 密钥。    |
|    静态激活密钥    |    静态激活密钥提供给不需要激活的产品。 它们可在无限次安装中使用。                                                                                                                  |
|    自定义密钥                 |    自定义密钥提供特殊操作或信息来激活或安装产品。                                                                                                                                                                |
|    VA 1.0                     |    这些是多次激活密钥，与 MAK 类似。                                                                                                                                                                                                 |
|    OEM 密钥                    |    这些是允许多次激活的原始设备制造商密钥。                                                                                                                                                                       |
|    DreamSpark 零售密钥    |    这些是 DreamSpark 的零售密钥，允许一次激活。 DreamSpark 零售密钥按批次签发，主要面向学生消费。                                                                                     |
|    DreamSpark 实验室密钥         |    这些是 DreamSpark 计划的实验室用途的密钥，允许多次激活。 DreamSpark 实验室密钥供高校计算机实验室方案使用。                                                                                       |
|    DreamSpark MAK 密钥         |    这些是面向 DreamSpark 计划消费者的 MAK 密钥。                                                                                                                                                                                                  |
|

可从产品的下载页索取密钥，或者在“[产品密钥](https://my.visualstudio.com/productkeys)”页上搜索所需的密钥。

### <a name="claiming-product-keys"></a>索取产品密钥
只有拥有活动订阅的订阅者才可下载产品和索取产品密钥。  当订阅处于活动状态时，可从“[产品密钥](https://my.visualstudio.com/productkeys)”页导出索取的密钥。

索取产品密钥：
1. 登录到你的 Visual Studio 订阅。  必须登录才能下载产品或索取产品密码。
2. 单击“[产品密钥](https://my.visualstudio.com/productkeys?wt.mc_id=o~msft~docs)”选项卡。
3. 产品密钥根据产品名称按字母顺序列出。  可以向下滚动到所需产品的名称，也可以使用页面顶部的搜索栏进行搜索。
   > [!div class="mx-imgBorder"]
   > ![搜索产品密钥](_img/product-keys/visio-product-key-cropped.png)

在此示例中，我们使用了搜索栏查找 Visio 2010 的产品密钥。
正如你所见，这里列出了几个版本的 Visio 2010。  为 Visio Standard 2010 和 Visio Premium 2010 分别索取了一个密钥，现在两者均剩余 4 个密钥。  已索取的这两个密钥为零售密钥，并且都显示在页面上。  注意，你可以在“注释”列记录有关已索取的密钥的简短说明。  可以结合“已索取”列中的日期，使用它来跟踪索取的密钥。  例如，可以在使用密钥激活产品的安装时进行记录。

### <a name="exporting-your-claimed-keys"></a>导出已索取的密钥
可以导出所有已索取的密钥以及众多自动标记为“已索取”的静态密钥和其他密钥的列表。

> [!IMPORTANT]
> 如果订阅到期，则无法索取新的密钥或导出已索取的密钥。

若要导出密钥，只需单击“产品密钥”页最右侧的“导出所有密钥”链接。  此时将创建名为 KeysExport.xml 的 .xml 文件，可选择打开或保存该文件。  你需要使用能够处理 .xml 文件的应用程序来打开此文件。  例如，可以将该文件作为 Excel 中的只读工作簿打开。

## <a name="internet-demonstrations-via-terminal-services"></a>通过终端服务访问 Internet 演示
凭借 Visual Studio 订阅，可允许最终用户使用终端服务（Windows Server 2003 或 Windows Server 2008）或远程桌面服务（Windows Server 2008 R2 或更高版本）访问你的程序的 Internet 演示。 使用这种方式，多达 200 位匿名用户可同时访问你的演示。 你的演示不得使用生产数据。 Visual Studio 订阅者可以向最终用户演示其应用程序。 在软件是通过 Visual Studio 订阅授权的情况下，未购买 Visual Studio 订阅的最终用户只能通过使用终端服务 (TS) 或远程桌面服务 (RDS) 的此 Internet 与演示应用程序交互。

除了开发/测试权限，Visual Studio 订阅者可以根据需要使用许多 RDS 或 TS 连接。

### <a name="enabling-rds-access"></a>启用 RDS 访问
Visual Studio 订阅者可以输入[订阅门户](https://my.visualstudio.com?wt.mc_id=o~msft~docs)的“[产品密钥](https://my.visualstudio.com/productkeys?wt.mc_id=o~msft~docs)”选项卡中的产品密钥，增加可通过 RDS 访问 Windows Server 的用户数量。 若要获得产品密钥，请连接到“产品密钥”页，然后向下滚动到正在运行的 Windows Server 版本。 找到“Windows Server <版本> R2 远程桌面服务 <用户或设备> 连接”，然后单击“索取密钥”链接。 例如，如果是在 Windows Server 2012 R2 上使用 RDS，且部署使用用户 CAL，请选择“Windows Server 2012 远程桌面服务用户连接(50)”。
每种类型的 5 个密钥都支持 Windows Server 2008 R2，每个密钥支持 20 个连接。 对于 Windows Server 2012 R2，每种类型提供 4 个密钥，每个密钥支持 50 个连接。

#### <a name="to-enable-additional-connections-in-windows-server"></a>在 Windows Server 中启用其他连接：
1. 打开服务器管理器。
2. 打开左侧导航窗格中的“服务器”列表。
3. 右键单击你的许可证服务器，然后选择“安装许可证”。
4. 完成向导中的步骤。  如果选择的是协议类型，请选择“许可证包(零售购买)”，然后输入从我的门户获得的产品密钥。

如果满足以下条件，最终用户可以通过 RDS 进行连接以访问应用程序：
- 用户必须为匿名（处于未经身份验证状态）。
- 必须使用 Internet 连接。
- 若要进行应用程序演示，最多可以使用 200 个并发用户连接。
- Visual Studio 订阅者必须获得启用用户连接所需的产品密钥。

如果需要获得有关如何在服务器上设置 RD 授权的说明，请参阅 [RD Licensing Configuration on Windows Server 2012](http://blogs.technet.com/b/askperf/archive/2013/09/20/rd-licensing-configuration-on-windows-server-2012.aspx)（Windows Server 2012 上的 RD 授权配置）。 如果存在任何疑问，请访问 [Microsoft 远程桌面服务论坛](https://social.technet.microsoft.com/Forums/windowsserver/home?forum=winserverTS)。
